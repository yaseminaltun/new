<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ðŸŽ‚ Ä°yi ki doÄŸdun!</title>
  <style>
    :root { --bg1:#0b1020; --bg2:#1a2a6c; --bg3:#b21f1f; --bg4:#fdbb2d; }
    * { box-sizing: border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#fff;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(253,187,45,.25), transparent 60%),
                  radial-gradient(900px 700px at 80% 20%, rgba(178,31,31,.22), transparent 55%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }
    .card{
      width:min(680px, 92vw);
      padding:24px 18px 20px;
      border-radius:24px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      text-align:center;
      position:relative;
    }
    h1{
      margin: 0 0 8px;
      font-size: clamp(24px, 4vw, 40px);
      letter-spacing:.3px;
    }
    .sub{
      margin: 0 0 18px;
      opacity:.92;
      font-size: clamp(14px, 2.6vw, 18px);
    }
    .controls{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin: 14px 0 0;
    }
    button{
      border:0;
      padding: 12px 16px;
      border-radius:14px;
      font-weight:700;
      cursor:pointer;
      color:#111;
      background: linear-gradient(135deg, #ffd56a, #ff9bd1);
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      transition: transform .08s ease;
    }
    button:active{ transform: translateY(1px) scale(.99); }
    .ghost{
      background: rgba(255,255,255,.12);
      color:#fff;
      border: 1px solid rgba(255,255,255,.2);
    }

    /* Cake */
    .cakeWrap{
      display:flex;
      justify-content:center;
      margin: 14px auto 8px;
      position:relative;
      height: 260px;
    }
    .cake{
      position:relative;
      width: 280px;
      height: 220px;
      transform: translateY(20px);
    }
    .plate{
      position:absolute; left:50%; transform:translateX(-50%);
      bottom:0;
      width: 320px; height: 26px;
      border-radius: 999px;
      background: rgba(255,255,255,.18);
      filter: blur(.2px);
    }
    .layer{
      position:absolute; left:50%; transform:translateX(-50%);
      width: 260px;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.18);
    }
    .layer.top{
      top: 64px; height: 56px;
      background: linear-gradient(180deg, #ffb3d9, #ff7fbf);
    }
    .layer.mid{
      top: 114px; height: 62px;
      background: linear-gradient(180deg, #ffe6a6, #ffcc4d);
    }
    .layer.bot{
      top: 168px; height: 64px;
      background: linear-gradient(180deg, #a7e4ff, #4fb9ff);
    }
    .icing{
      position:absolute; left:50%; transform:translateX(-50%);
      top: 54px;
      width: 270px; height: 36px;
      border-radius: 999px;
      background: rgba(255,255,255,.22);
      box-shadow: inset 0 -10px 18px rgba(0,0,0,.08);
    }
    .drip{
      position:absolute;
      top: 78px;
      width: 18px; height: 38px;
      background: rgba(255,255,255,.22);
      border-radius: 0 0 18px 18px;
      filter: blur(.1px);
      box-shadow: inset 0 -8px 12px rgba(0,0,0,.06);
    }
    .drip:nth-child(1){ left: 30px; height: 42px; }
    .drip:nth-child(2){ left: 88px; height: 30px; }
    .drip:nth-child(3){ left: 150px; height: 46px; }
    .drip:nth-child(4){ left: 210px; height: 34px; }

    .candle{
      position:absolute;
      left:50%; transform:translateX(-50%);
      top: 16px;
      width: 18px; height: 70px;
      border-radius: 10px;
      background: repeating-linear-gradient(
        45deg,
        #fff 0 8px,
        #ff5aa5 8px 16px
      );
      border: 1px solid rgba(0,0,0,.15);
      box-shadow: 0 10px 18px rgba(0,0,0,.18);
    }
    .wick{
      position:absolute;
      left:50%; transform:translateX(-50%);
      top: -10px;
      width: 3px; height: 12px;
      background:#2a2a2a;
      border-radius: 2px;
    }
    .flame{
      position:absolute;
      left:50%; transform:translateX(-50%);
      top:-34px;
      width: 28px; height: 38px;
      background: radial-gradient(circle at 50% 60%, #fff7b0 0 30%, #ffb300 55%, #ff5a00 80%);
      border-radius: 50% 50% 50% 50%;
      filter: drop-shadow(0 0 18px rgba(255,200,60,.8));
      transform-origin: 50% 90%;
      animation: flicker .12s infinite alternate ease-in-out;
    }
    @keyframes flicker{
      from { transform: translateX(-50%) rotate(-2deg) scaleY(1.02); opacity:.95; }
      to   { transform: translateX(-50%) rotate( 2deg) scaleY(.98); opacity:1; }
    }
    .flame.off{
      opacity:0;
      animation:none;
      filter:none;
    }

    /* Confetti */
    .confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .piece{
      position:absolute;
      top:-10px;
      width:10px; height:14px;
      opacity:.9;
      transform: rotate(0deg);
      animation: fall linear forwards;
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(720deg); }
    }

    .footerNote{
      margin-top: 12px;
      opacity:.8;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="confetti" id="confetti"></div>

  <main class="card">
    <h1 id="title">ðŸŽ‰ Ä°yi ki doÄŸdun!</h1>
    <p class="sub" id="subtitle">Dilek tut ve mumu Ã¼fle âœ¨</p>

    <section class="cakeWrap" aria-label="DoÄŸum gÃ¼nÃ¼ pastasÄ±">
      <div class="cake" role="img" aria-label="Mumlu doÄŸum gÃ¼nÃ¼ pastasÄ±">
        <div class="candle">
          <div class="wick"></div>
          <div class="flame" id="flame"></div>
        </div>

        <div class="icing">
          <div class="drip"></div><div class="drip"></div><div class="drip"></div><div class="drip"></div>
        </div>

        <div class="layer top"></div>
        <div class="layer mid"></div>
        <div class="layer bot"></div>
        <div class="plate"></div>
      </div>
    </section>

    <div class="controls">
      <button id="playBtn">ÅžarkÄ±yÄ± BaÅŸlat ðŸŽµ</button>
      <button id="blowBtn" class="ghost">Mumu SÃ¶ndÃ¼r ðŸ’¨</button>
    </div>

    <div class="footerNote">
      (Ä°pucu: Linke isim ekleyebilirsin: <code>?name=AyÅŸe</code>)
    </div>
  </main>

  <script>
    // --- Personalize with ?name=
    const params = new URLSearchParams(location.search);
    const name = params.get("name");
    if (name) {
      document.getElementById("title").textContent = `ðŸŽ‰ Ä°yi ki doÄŸdun, ${name}!`;
      document.title = `ðŸŽ‚ Ä°yi ki doÄŸdun, ${name}!`;
    }

    // --- Confetti
    const confettiRoot = document.getElementById("confetti");
    function burstConfetti(count = 120) {
      for (let i = 0; i < count; i++) {
        const p = document.createElement("div");
        p.className = "piece";
        p.style.left = Math.random() * 100 + "vw";
        p.style.animationDuration = (Math.random() * 1.8 + 1.6) + "s";
        p.style.animationDelay = (Math.random() * 0.2) + "s";
        p.style.borderRadius = (Math.random() > 0.5 ? "2px" : "999px");
        p.style.background = `hsl(${Math.floor(Math.random() * 360)}, 90%, 60%)`;
        p.style.transform = `rotate(${Math.random() * 360}deg)`;
        p.style.width = (Math.random() * 8 + 6) + "px";
        p.style.height = (Math.random() * 12 + 8) + "px";
        p.style.animationName = "fall";
        confettiRoot.appendChild(p);
        setTimeout(() => p.remove(), 4000);
      }
    }

    // --- Candle flame toggle
    const flame = document.getElementById("flame");
    function setFlame(on) {
      flame.classList.toggle("off", !on);
      if (!on) burstConfetti(160);
    }

    // --- HAPPY BIRTHDAY melody (WebAudio) - no external audio file needed
    let audioCtx = null;
    let isPlaying = false;

    const NOTE = {
      C4: 261.63, D4: 293.66, E4: 329.63, F4: 349.23, G4: 392.00, A4: 440.00, B4: 493.88,
      C5: 523.25, D5: 587.33, E5: 659.25, F5: 698.46, G5: 783.99
    };

    // Happy Birthday (common simple arrangement) in C major-ish
    const melody = [
      ["G4", 0.35], ["G4", 0.35], ["A4", 0.7],  ["G4", 0.7],  ["C5", 0.7], ["B4", 1.0],
      ["G4", 0.35], ["G4", 0.35], ["A4", 0.7],  ["G4", 0.7],  ["D5", 0.7], ["C5", 1.0],
      ["G4", 0.35], ["G4", 0.35], ["G5", 0.7],  ["E5", 0.7],  ["C5", 0.7], ["B4", 0.7], ["A4", 1.0],
      ["F5", 0.35], ["F5", 0.35], ["E5", 0.7],  ["C5", 0.7],  ["D5", 0.7], ["C5", 1.2],
    ];

    function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

    async function playTone(freq, durationSec) {
      if (!audioCtx) return;
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();

      o.type = "triangle";
      o.frequency.value = freq;

      // envelope
      const now = audioCtx.currentTime;
      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.25, now + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, now + durationSec);

      o.connect(g).connect(audioCtx.destination);
      o.start(now);
      o.stop(now + durationSec);

      await sleep(durationSec * 1000);
    }

    async function playMelody() {
      if (isPlaying) return;
      isPlaying = true;

      // must be created on user gesture (button click) for mobile autoplay rules
      audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
      if (audioCtx.state === "suspended") await audioCtx.resume();

      setFlame(true);
      burstConfetti(120);

      for (const [n, d] of melody) {
        await playTone(NOTE[n], d);
        await sleep(40);
      }

      isPlaying = false;
    }

    document.getElementById("playBtn").addEventListener("click", playMelody);

    document.getElementById("blowBtn").addEventListener("click", () => {
      setFlame(false);
    });

    // little extra: tap the cake to toggle flame
    document.querySelector(".cake").addEventListener("click", () => {
      const off = flame.classList.contains("off");
      setFlame(off); // if off -> on, if on -> off? (inverse)
      // Actually: setFlame(off) turns ON when off==true. Nice toggle.
    });
  </script>
</body>
</html>
